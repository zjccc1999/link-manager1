# Link Manager

ä¸€ä¸ªéƒ¨ç½²åœ¨ **Cloudflare Workers** ä¸Šçš„è½»é‡çº§é“¾æ¥ç®¡ç†å·¥å…·ï¼Œç”¨æ¥é›†ä¸­ç®¡ç†å¸¸ç”¨ç½‘å€ã€èµ„æºä¸è·³è½¬å…¥å£ã€‚

- å‰ç«¯ï¼šReact + TypeScript + Vite + TailwindCSS
- åç«¯ï¼šCloudflare Workers
- æ•°æ®æŒä¹…åŒ–ï¼šCloudflare KVï¼ˆå‘½åç©ºé—´ï¼š`LINKS_KV`ï¼‰

## åŠŸèƒ½ç‰¹æ€§

- âœ… åˆ†ç±»ç®¡ç†é“¾æ¥ï¼ˆæ”¯æŒå¤šåˆ†ç±»ï¼‰
- âœ… å­é“¾æ¥ / å¿«æ·å…¥å£ï¼ˆä¾‹å¦‚ï¼šGitHub Issues / PRsã€æ§åˆ¶å°å…¥å£ç­‰ï¼‰
- âœ… æ”¯æŒæŒ‰ã€Œæ ‡é¢˜ / æè¿° / å­é“¾æ¥ã€æœç´¢
- âœ… æ‹–æ‹½æ’åºåˆ†ç±»å’Œé“¾æ¥
- âœ… æ•°æ®å¤‡ä»½ / å¯¼å…¥ï¼ˆJSON æ–‡ä»¶ï¼‰
- âœ… ç®€å•å¯†ç ä¿æŠ¤ï¼ˆé»˜è®¤å¯†ç ï¼Œå¯åœ¨çº¿ä¿®æ”¹ï¼‰

---

é»˜è®¤ç™»å½•å¯†ç ï¼š`linkmanager`ï¼ˆéƒ¨ç½²åè®°å¾—ä¿®æ”¹,å¦‚æœå¿˜è®°å¯†ç çœ‹æœ«å°¾ï¼‰

---

## ä¸€é”®éƒ¨ç½²åˆ° Cloudflare

ä½ éœ€è¦å‡†å¤‡ï¼š

- ä¸€ä¸ª Cloudflare è´¦å·
- ç»‘å®šæ”¯ä»˜æ–¹å¼çš„è´¦æˆ·ï¼ˆå…è´¹å¥—é¤å³å¯ï¼‰

ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å³å¯ä¸€é”®éƒ¨ç½²åˆ°ä½ è‡ªå·±çš„ Cloudflare è´¦æˆ·ä¸­ï¼š

[![Deploy to Cloudflare](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/morty626/link-manager)

Cloudflare å¤§è‡´ä¼šå®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. è¯»å–æœ¬ä»“åº“ä»£ç ï¼ˆå¿…è¦æ—¶å¸®ä½  Fork ä¸€ä»½ï¼‰
2. æ ¹æ® `wrangler.jsonc` åˆ›å»ºï¼š
   - Worker æœåŠ¡ï¼š`link-manager`
   - KV å‘½åç©ºé—´ï¼š`LINKS_KV`
   - ç»‘å®šé™æ€èµ„æºï¼ˆ`dist/`ï¼‰åˆ° Worker çš„ `ASSETS`
3. å®Œæˆæ„å»ºä¸éƒ¨ç½²ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå½¢å¦‚ `xxx.workers.dev` çš„è®¿é—®åŸŸå

### éƒ¨ç½²æµç¨‹ç¤ºæ„

åˆ›å»º / éƒ¨ç½² Workerï¼š

![Link Manager åˆ›å»ºä¸éƒ¨ç½²](./docs/images/screenshot-create.png)

æŸ¥çœ‹éƒ¨ç½²å®Œæˆåçš„åŸŸåï¼š

![Link Manager éƒ¨ç½²åçš„åŸŸå](./docs/images/screenshot-domain.png)

é¦–æ¬¡è®¿é—®æ—¶ï¼Œä¼šçœ‹åˆ°ç™»å½•é¡µé¢ï¼ˆé»˜è®¤å¯†ç è§ä¸‹æ–¹ï¼‰ï¼š

![Link Manager ç™»å½•ç•Œé¢](./docs/images/screenshot-login.png)

---

## ğŸ” ç™»å½•ä¸å¯†ç è¯´æ˜

- é»˜è®¤å¯†ç ä¸ºï¼š

  ```text
  linkmanager
  ```

- é¦–æ¬¡éƒ¨ç½²åï¼š

  1. åœ¨æµè§ˆå™¨è®¿é—®ä½ çš„ Worker åŸŸåï¼ˆæˆ–è‡ªå®šä¹‰åŸŸåï¼‰
  2. è¾“å…¥é»˜è®¤å¯†ç ç™»å½•
  3. ç™»å½•åå¯åœ¨é¡µé¢å·¦ä¸‹è§’ç‚¹å‡» **ã€Œä¿®æ”¹å¯†ç ã€** æŒ‰é’®ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„å¯†ç 

> å¯†ç ä¸ä¼šä»¥æ˜æ–‡å½¢å¼å­˜å‚¨ï¼Œè€Œæ˜¯ä»¥å“ˆå¸Œå½¢å¼å­˜å‚¨åœ¨ Cloudflare KV ä¸­ï¼ˆé”®åï¼š`app_config_v1`ï¼‰ã€‚

ç™»å½•æˆåŠŸåçš„é¦–é¡µæ•ˆæœç¤ºæ„ï¼ˆé»˜è®¤æ˜¯ç©ºçŠ¶æ€ï¼Œä¸‹å›¾ä¸ºæ·»åŠ ç¤ºä¾‹æ•°æ®åçš„æ ·å­ï¼‰ï¼š

![Link Manager é¦–é¡µç•Œé¢](./docs/images/screenshot-home.png)

---

## æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# æœ¬åœ°å¼€å‘ï¼ˆåªè·‘å‰ç«¯ Viteï¼Œèµ° localStorage æ¨¡å¼ä¹Ÿå¯ä»¥ä½“éªŒï¼‰
npm run dev

# æ„å»ºå‰ç«¯
npm run build

# ä½¿ç”¨ Cloudflare Workers æœ¬åœ°ç¯å¢ƒï¼ˆä½¿ç”¨ dist é™æ€èµ„æº + æœ¬åœ° KVï¼‰
npx wrangler dev
```

è®¿é—®åœ°å€ï¼š

- Vite å¼€å‘æœåŠ¡å™¨ï¼š`http://localhost:5173`
- Wrangler Devï¼ˆå®Œæ•´ Worker + é™æ€èµ„æºï¼‰ï¼š`http://localhost:8787`

---

## æŠ€æœ¯è¯´æ˜

### æ•°æ®å­˜å‚¨

å‰ç«¯é€šè¿‡åŒæºæ¥å£ `/api/data` ä¸ Worker é€šä¿¡ï¼š

- `GET /api/data`ï¼šä» KV ä¸­è¯»å–å®Œæ•´æ•°æ®ç»“æ„ï¼š

  ```ts
  {
    categories: Category[];
    links: LinkItem[];
  }
  ```

- `POST /api/data`ï¼šå°†æœ€æ–°çš„ `{ categories, links }` å†™å…¥ KV

åœ¨ Worker ä¸­ï¼Œé€šè¿‡ `env.LINKS_KV` è®¿é—® KVï¼Œæ ¸å¿ƒé€»è¾‘åœ¨ `worker/index.ts` ä¸­å®ç°ã€‚

KV ä¸­ç›®å‰ä¼šç”¨åˆ°ä¸¤ä¸ª keyï¼š

- `APP_DATA`ï¼šä¿å­˜åˆ†ç±»ä¸é“¾æ¥æ•°æ®
- `app_config_v1`ï¼šä¿å­˜åº”ç”¨é…ç½®ï¼Œç›®å‰åªåŒ…å« `passwordHash` å­—æ®µ

åœ¨ Cloudflare KV / Workers æ— æ³•è®¿é—®æ—¶ï¼ˆä¾‹å¦‚æœ¬åœ°ä»…è¿è¡Œ `npm run dev`ï¼‰ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨å›é€€åˆ°æµè§ˆå™¨ `localStorage` å­˜å‚¨ï¼Œä¿è¯åŠŸèƒ½åŸºæœ¬å¯ç”¨ã€‚

### è®¿é—®æ§åˆ¶ä¸ Cookie

- ç™»å½•æˆåŠŸåï¼Œåç«¯ä¼šè®¾ç½®ä¸€ä¸ª `LM_AUTH` Cookieï¼Œä¿å­˜å¯†ç å“ˆå¸Œï¼Œç”¨äºåç»­è¯·æ±‚é‰´æƒ
- æ‰€æœ‰ `/api/data` è¯·æ±‚éƒ½éœ€è¦å·²ç™»å½•ï¼Œå¦åˆ™ä¼šè¿”å› `401 Unauthorized`
- ä¿®æ”¹å¯†ç æ¥å£ä¸ºï¼š`POST /api/change-password`

---

## è‡ªå®šä¹‰åŸŸåç»‘å®šï¼ˆå¯é€‰ï¼‰

éƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥åœ¨ Cloudflare åå°ä¸º Worker ç»‘å®šè‡ªå·±çš„åŸŸåï¼Œä¾‹å¦‚ï¼š

- `link-manager.xxxxx.com`

æ“ä½œè·¯å¾„ï¼š

> **Workers & Pages â†’ é€‰æ‹©ä½ çš„ Worker â†’ Custom Domains â†’ Add custom domain**

åœ¨è¾“å…¥æ¡†ä¸­å¡«å…¥ä½ æƒ³è¦çš„å­åŸŸåï¼Œä¾‹å¦‚ï¼š

- `link-manager.xxxxx.com`
  xxxxx.com ä¸ºä½ å·²ç»æ‰˜ç®¡åœ¨ cf ä¸Šçš„åŸŸå

ä¿å­˜åï¼ŒCloudflare ä¼šè‡ªåŠ¨ï¼š

- ä¸ºè¯¥å­åŸŸååˆ›å»ºå¯¹åº”çš„ DNS è®°å½•
- è‡ªåŠ¨ç­¾å‘ SSL è¯ä¹¦

å‚è€ƒç¤ºæ„å›¾ï¼š

![Link Manager è‡ªå®šä¹‰åŸŸå](./docs/images/screenshot-add_customer_domain.png)

---

## é‡ç½®å¯†ç 

å¦‚æœä½ å¿˜è®°äº†ç™»å½•å¯†ç ï¼Œä½†ä»ç„¶å¯ä»¥è®¿é—® Cloudflare ç®¡ç†åå°ï¼Œå¯ä»¥é€šè¿‡æ¸…ç† KV é…ç½®æ¥æ¢å¤é»˜è®¤å¯†ç ã€‚

æ­¥éª¤ï¼š

1. æ‰“å¼€ Cloudflare æ§åˆ¶å° â†’ **Workers & Pages**
2. è¿›å…¥ä½ çš„ Worker æœåŠ¡ â†’ æ‰¾åˆ°ç»‘å®šçš„ KV å‘½åç©ºé—´ `LINKS_KV`ï¼ˆä¾‹å¦‚ï¼š`link-manager-links-kv`ï¼‰
3. åœ¨ KV ç®¡ç†é¡µé¢ä¸­ï¼š

   - æ‰¾åˆ°å¹¶ **åˆ é™¤ keyï¼š`app_config_v1`**
   - **ä¸è¦åˆ é™¤** `APP_DATA`ï¼ˆé‚£æ˜¯ä½ çš„æ‰€æœ‰é“¾æ¥æ•°æ®ï¼‰

4. åˆ é™¤ `app_config_v1` åï¼Œå†æ¬¡è®¿é—®é¡µé¢ï¼š

   - å¯†ç ä¼šæ¢å¤ä¸ºé»˜è®¤å¯†ç  `linkmanager`ï¼ˆæˆ–ä½ åœ¨ä»£ç ä¸­è®¾ç½®çš„ `DEFAULT_PASSWORD`ï¼‰

5. ä½¿ç”¨é»˜è®¤å¯†ç ç™»å½•åï¼Œç«‹åˆ»åœ¨é¡µé¢å†…é‡æ–°è®¾ç½®ä¸€ä¸ªæ–°çš„å¯†ç 

---

## License

MIT

```
::contentReference[oaicite:0]{index=0}
```
